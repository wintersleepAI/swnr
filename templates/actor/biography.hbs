{{! Biography Tab }}
<section
  class='tab biography sheet-body {{tab.cssClass}}'
  data-group='primary'
  data-tab='biography'
>
  <div class="flex flex-col">
    <div class="flex flexrow" style="margin:2px;gap:2px;">
      {{#if (eq actor.type 'character')}}
        {{formGroup systemFields.class value=system.class localize=true}}
        {{formGroup systemFields.species value=system.species localize=true}}
        {{formGroup systemFields.homeworld value=system.homeworld localize=true}}
        {{formGroup systemFields.background value=system.background localize=true}}
        {{formGroup systemFields.employer value=system.employer localize=true}}
      {{/if}}
    </div>

    {{#if (eq actor.type 'character')}}
      <div class="languages-section" style="margin: 10px 0;">
        <ol class="items-list">
          <li class="items-header flexrow">
            <div class="item-name">
              {{localize 'swnr.sheet.languages'}}
            </div>
            <div class="item-controls">
              {{#if @root.editable}}
                {{#if availableLanguages.length}}
                  <a class="item-control language-toggle" title="{{localize 'swnr.sheet.addLanguage'}}" data-action="toggleLanguageAdd">
                    <i class="fas fa-plus"></i>
                  </a>
                {{/if}}
              {{/if}}
            </div>
          </li>
        </ol>
        
        <!-- Language Add Container (hidden by default) -->
        {{#if @root.editable}}
          <div class="language-add-container" id="language-add-section" style="display: none; padding: 8px; background-color: var(--color-form-disabled); border-radius: 3px; margin-bottom: 8px;">
            <select class="language-select" name="language-add-select">
              <option value="">{{localize 'swnr.sheet.selectLanguage'}}</option>
              {{#each availableLanguages as |language|}}
                {{#unless (includes @root.system.languages language)}}
                  <option value="{{language}}">{{language}}</option>
                {{/unless}}
              {{/each}}
            </select>
            <button type="button" class="language-add-btn" data-action="addLanguage" title="{{localize 'swnr.sheet.addLanguage'}}">
              <i class="fas fa-plus"></i>
            </button>
          </div>
        {{/if}}

        <!-- Languages List -->
        <div class="languages-list">
          {{#each system.languages as |language index|}}
            <div class="language-item" data-lang-index="{{index}}">
              <span class="language-name">{{language}}</span>
              {{#if @root.editable}}
                <button type="button" class="language-remove" data-action="removeLanguage" data-lang-index="{{index}}" title="{{localize 'swnr.sheet.removeLanguage'}}">
                  <i class="fas fa-trash"></i>
                </button>
              {{/if}}
            </div>
          {{/each}}
          
          {{#unless availableLanguages.length}}
            {{#if @root.editable}}
              <div class="no-languages-warning">
                <em>{{localize 'swnr.sheet.noLanguagesConfigured'}}</em>
              </div>
            {{/if}}
          {{/unless}}
        </div>
      </div>
    {{/if}}
    
    <div>
      <h3>{{localize 'SWN.Actor.Tabs.Biography'}}</h3>
    </div>

    {{#if editable}} 
      <div class="editor">
        <prose-mirror
          name="system.biography"
          data-document-u-u-i-d="{{actor.uuid}}"
          value="{{system.biography}}"
          collaborate="true"
          toggled="true"
        >
          {{{enrichedBiography}}}
        </prose-mirror>
      </div>
    {{else}} 
      <div class="editor">
        <div class="editor-content">
          {{{enrichedBiography}}}
        </div>
      </div>
    {{/if}}

  </div>
</section>
